本项目涉及两个表格作为输入参数，一个是**日表格**，一个是**周表格**

需要指定一个输出表格的位置

需要指定一个初始仓位

## 使用方法

### 法一

打开code文件夹，找到main.py

进入您配置好的环境中，请选择合适的解释器，包含依赖环境中需要的包

调整文件路径参数为您计算机上的，调整初始仓位：

input_file为日表，input_file2为周表

output是输出路径，最后会输出一个彩色的xlsx，请确保以xlsx结尾

initial_pos是初始仓位

![image-20250806145401392](C:\Users\Thriller\AppData\Roaming\Typora\typora-user-images\image-20250806145401392.png)

### 法二

双击`main_GUI.exe`,打开GUI后，选择您目录下对应的资源文件`日表`,`周表`,`输出路径`

## 数据说明

测试数据里面的resource.xlsx和husen.xlsx分别是日和周的，请根据需要替换,尽可能确保有相同的表头

resource存放两个测试数据



result里面的效果可以直接查看！！！

result里面的效果可以直接查看！！！

result里面的效果可以直接查看！！！

表格中新增了sum列为总仓位列，其他的仓位变化已经标上了颜色

## 函数说明

**code中存放函数：**

​	mian：主函数，请更改资源函数路径后运行

​		pcr_bbi_new:pcr+bbi的策略函数

​		xichou_fun:吸筹判断函数

​		husen_new:周度牛熊线策略

​		function_new:振幅预警+日度收盘价下穿策略

​			API:衔接的是周度表结论放入日度表的接口，不是访问网页的接口

​			cross：判断下穿

​			tradeday：计算交易日

​	sum：仓位求和函数，对'吸筹总仓位','振幅指标仓位','周度bbi仓位调整'进行求和

​		注意！吸筹总仓位已经包含了对pcr_bbi仓位调整的加和

​	color：染色函数，详见染色说明

## 需要的依赖环境

pandas

numpy

openpyxl

## 颜色说明

“**PCR百分位大于90%且持仓量PCR的值大于100%**”的“PCR百分位”格子和“持仓量PCR”格子里的字是==红色==的

“**当PCR百分位小于15%时”的“PCR百分位**”格子里的字是==绿色==的

**“吸筹值”中大于80**的格子里的字是==蓝色==的

**“振幅”超过2.5%，且当日“涨跌幅”为负数**的“振幅”、“涨跌幅”格子里的字是==橙色==的

